<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2815px" preserveAspectRatio="none" style="width:902px;height:2815px;background:#FFFFFF;" version="1.1" viewBox="0 0 902 2815" width="902px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="637.7266" style="stroke:#000000;stroke-width:1.5;" width="636.5" x="71" y="235.2266"/><rect fill="none" height="257.3281" style="stroke:#000000;stroke-width:1.5;" width="607.5" x="81" y="259.3594"/><rect fill="none" height="219.9297" style="stroke:#000000;stroke-width:1.5;" width="616.5" x="81" y="646.0234"/><rect fill="none" height="77.3984" style="stroke:#000000;stroke-width:1.5;" width="569" x="316" y="1001.3516"/><rect fill="none" height="250.1953" style="stroke:#000000;stroke-width:1.5;" width="569" x="316" y="1092.75"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="119" x2="119" y1="36.2969" y2="2383.7266"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="119" x2="119" y1="2383.7266" y2="2424.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="119" x2="119" y1="2424.5313" y2="2779.7656"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="352" x2="352" y1="36.2969" y2="2383.7266"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="352" x2="352" y1="2383.7266" y2="2424.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="352" x2="352" y1="2424.5313" y2="2779.7656"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="542.5" x2="542.5" y1="36.2969" y2="2383.7266"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="542.5" x2="542.5" y1="2383.7266" y2="2424.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="542.5" x2="542.5" y1="2424.5313" y2="2779.7656"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="715" x2="715" y1="36.2969" y2="2383.7266"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="715" x2="715" y1="2383.7266" y2="2424.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="715" x2="715" y1="2424.5313" y2="2779.7656"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="816" x2="816" y1="36.2969" y2="2383.7266"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="816" x2="816" y1="2383.7266" y2="2424.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="816" x2="816" y1="2424.5313" y2="2779.7656"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="91" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="98" y="24.9951">Admin</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="57" x="91" y="2778.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="98" y="2798.7607">Admin</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="53" x="326" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="333" y="24.9951">Client</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="53" x="326" y="2778.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="333" y="2798.7607">Client</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="58" x="513.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="520.5" y="24.9951">Server</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="58" x="513.5" y="2778.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="520.5" y="2798.7607">Server</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="43" x="694" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="701" y="24.9951">IPFS</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="43" x="694" y="2778.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="701" y="2798.7607">IPFS</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="117" x="758" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="765" y="24.9951">Smart Contract</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="117" x="758" y="2778.7656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="765" y="2798.7607">Smart Contract</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="895" x="0" y="66.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="895" y1="66.8633" y2="66.8633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="895" y1="69.8633" y2="69.8633"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="178" x="358.5" y="56.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="159" x="364.5" y="72.3638">Setup software steps</text><path d="M5,94.4297 L5,164.4297 L468,164.4297 L468,104.4297 L458,94.4297 L5,94.4297 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M458,94.4297 L458,104.4297 L468,104.4297 L458,94.4297 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="419" x="11" y="111.4966">When admin installs software on client and server it sets by config</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="347" x="11" y="126.6294">its own public key. Also it sets smart contract address.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="11" y="141.7622">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="442" x="11" y="156.895">So software can trust particular smart contract and admin public key.</text><polygon fill="#181818" points="340.5,187.0938,350.5,191.0938,340.5,195.0938,344.5,191.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="119.5" x2="346.5" y1="191.0938" y2="191.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="126.5" y="186.0278">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="139.5" y="186.0278">Install DPKI software</text><polygon fill="#181818" points="530.5,216.2266,540.5,220.2266,530.5,224.2266,534.5,220.2266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="119.5" x2="536.5" y1="220.2266" y2="220.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="126.5" y="215.1606">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="139.5" y="215.1606">Install DPKI software</text><path d="M71,235.2266 L135,235.2266 L135,242.3594 L125,252.3594 L71,252.3594 L71,235.2266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="637.7266" style="stroke:#000000;stroke-width:1.5;" width="636.5" x="71" y="235.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="86" y="248.2935">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="78" x="150" y="247.437">[Auto mode]</text><path d="M81,259.3594 L151,259.3594 L151,266.4922 L141,276.4922 L81,276.4922 L81,259.3594 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="257.3281" style="stroke:#000000;stroke-width:1.5;" width="607.5" x="81" y="259.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="96" y="272.4263">par</text><path d="M227,281.4922 L227,366.4922 L668,366.4922 L668,291.4922 L658,281.4922 L227,281.4922 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M658,281.4922 L658,291.4922 L668,291.4922 L658,281.4922 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="302" x="233" y="298.5591">This generated key pair is not related with SSH.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="420" x="233" y="313.6919">We need it to work with smart contract and to interact with admin.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="347" x="233" y="328.8247">That's key pair is more sensentive than SSH key pairs.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="393" x="233" y="343.9575">That's why generation should be processed automatically and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="233" y="359.0903">should  never leave device.</text><line style="stroke:#181818;stroke-width:1.0;" x1="352.5" x2="394.5" y1="393.2891" y2="393.2891"/><line style="stroke:#181818;stroke-width:1.0;" x1="394.5" x2="394.5" y1="393.2891" y2="406.2891"/><line style="stroke:#181818;stroke-width:1.0;" x1="353.5" x2="394.5" y1="406.2891" y2="406.2891"/><polygon fill="#181818" points="363.5,402.2891,353.5,406.2891,363.5,410.2891,359.5,406.2891" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="359.5" y="388.2231">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="372.5" y="388.2231">Generate key pair</text><polygon fill="#181818" points="130.5,431.4219,120.5,435.4219,130.5,439.4219,126.5,435.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="124.5" x2="351.5" y1="435.4219" y2="435.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="136.5" y="430.356">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="149.5" y="430.356">Send public key</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="81" x2="688.5" y1="444.4219" y2="444.4219"/><line style="stroke:#181818;stroke-width:1.0;" x1="542.5" x2="584.5" y1="466.5547" y2="466.5547"/><line style="stroke:#181818;stroke-width:1.0;" x1="584.5" x2="584.5" y1="466.5547" y2="479.5547"/><line style="stroke:#181818;stroke-width:1.0;" x1="543.5" x2="584.5" y1="479.5547" y2="479.5547"/><polygon fill="#181818" points="553.5,475.5547,543.5,479.5547,553.5,483.5547,549.5,479.5547" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="549.5" y="461.4888">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="562.5" y="461.4888">Generate key pair</text><polygon fill="#181818" points="130.5,504.6875,120.5,508.6875,130.5,512.6875,126.5,508.6875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="124.5" x2="541.5" y1="508.6875" y2="508.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="136.5" y="503.6216">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="149.5" y="503.6216">Send public key</text><path d="M93,528.6875 L93,568.6875 L568,568.6875 L568,538.6875 L558,528.6875 L93,528.6875 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M558,528.6875 L558,538.6875 L568,538.6875 L558,528.6875 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230" x="211.25" y="545.7544">So admin knows devices public keys</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227" x="211.25" y="560.8872">and devices know admin public key.</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="71" x2="707.5" y1="574.9531" y2="574.9531"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="96" x="76" y="585.1636">[Manual mode]</text><path d="M319,593.7578 L319,633.7578 L575,633.7578 L575,603.7578 L565,593.7578 L319,593.7578 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M565,593.7578 L565,603.7578 L575,603.7578 L565,593.7578 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235" x="325" y="610.8247">In this case admin can get public key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235" x="325" y="625.9575">from device on installation or after it.</text><path d="M81,646.0234 L151,646.0234 L151,653.1563 L141,663.1563 L81,663.1563 L81,646.0234 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="219.9297" style="stroke:#000000;stroke-width:1.5;" width="616.5" x="81" y="646.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="96" y="659.0903">par</text><line style="stroke:#181818;stroke-width:1.0;" x1="352.5" x2="394.5" y1="684.2891" y2="684.2891"/><line style="stroke:#181818;stroke-width:1.0;" x1="394.5" x2="394.5" y1="684.2891" y2="697.2891"/><line style="stroke:#181818;stroke-width:1.0;" x1="353.5" x2="394.5" y1="697.2891" y2="697.2891"/><polygon fill="#181818" points="363.5,693.2891,353.5,697.2891,363.5,701.2891,359.5,697.2891" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="359.5" y="679.2231">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="372.5" y="679.2231">Generate key pair</text><polygon fill="#181818" points="340.5,722.4219,350.5,726.4219,340.5,730.4219,344.5,726.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="119.5" x2="346.5" y1="726.4219" y2="726.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="126.5" y="721.356">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="139.5" y="721.356">Get public key from device</text><polygon fill="#181818" points="130.5,751.5547,120.5,755.5547,130.5,759.5547,126.5,755.5547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="124.5" x2="351.5" y1="755.5547" y2="755.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="136.5" y="750.4888">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="149.5" y="750.4888">Public key</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="81" x2="697.5" y1="764.5547" y2="764.5547"/><line style="stroke:#181818;stroke-width:1.0;" x1="542.5" x2="584.5" y1="786.6875" y2="786.6875"/><line style="stroke:#181818;stroke-width:1.0;" x1="584.5" x2="584.5" y1="786.6875" y2="799.6875"/><line style="stroke:#181818;stroke-width:1.0;" x1="543.5" x2="584.5" y1="799.6875" y2="799.6875"/><polygon fill="#181818" points="553.5,795.6875,543.5,799.6875,553.5,803.6875,549.5,799.6875" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="549.5" y="781.6216">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="571.5" y="781.6216">Generate key pair</text><polygon fill="#181818" points="530.5,824.8203,540.5,828.8203,530.5,832.8203,534.5,828.8203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="119.5" x2="536.5" y1="828.8203" y2="828.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="126.5" y="823.7544">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="148.5" y="823.7544">Get public key from device</text><polygon fill="#181818" points="130.5,853.9531,120.5,857.9531,130.5,861.9531,126.5,857.9531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="124.5" x2="541.5" y1="857.9531" y2="857.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="136.5" y="852.8872">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="158.5" y="852.8872">Public key</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="895" x="0" y="900.5195"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="895" y1="900.5195" y2="900.5195"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="895" y1="903.5195" y2="903.5195"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="199" x="348" y="889.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="180" x="354" y="906.02">Broadcast CA certificate</text><line style="stroke:#181818;stroke-width:1.0;" x1="119.5" x2="161.5" y1="944.2188" y2="944.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="161.5" x2="161.5" y1="944.2188" y2="957.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="120.5" x2="161.5" y1="957.2188" y2="957.2188"/><polygon fill="#181818" points="130.5,953.2188,120.5,957.2188,130.5,961.2188,126.5,957.2188" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="126.5" y="939.1528">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="148.5" y="939.1528">Generate new SSH CA key pair</text><polygon fill="#181818" points="804.5,982.3516,814.5,986.3516,804.5,990.3516,808.5,986.3516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="119.5" x2="810.5" y1="986.3516" y2="986.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="126.5" y="981.2856">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="148.5" y="981.2856">Save new SSH CA public key</text><path d="M316,1001.3516 L386,1001.3516 L386,1008.4844 L376,1018.4844 L316,1018.4844 L316,1001.3516 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="77.3984" style="stroke:#000000;stroke-width:1.5;" width="569" x="316" y="1001.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="331" y="1014.4185">par</text><polygon fill="#181818" points="363.5,1035.6172,353.5,1039.6172,363.5,1043.6172,359.5,1039.6172" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="357.5" x2="815.5" y1="1039.6172" y2="1039.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="369.5" y="1034.5513">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228" x="391.5" y="1034.5513">Notify about new SSH CA public key</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="316" x2="885" y1="1048.6172" y2="1048.6172"/><polygon fill="#181818" points="553.5,1066.75,543.5,1070.75,553.5,1074.75,549.5,1070.75" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="547.5" x2="815.5" y1="1070.75" y2="1070.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="559.5" y="1065.6841">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228" x="581.5" y="1065.6841">Notify about new SSH CA public key</text><path d="M316,1092.75 L386,1092.75 L386,1099.8828 L376,1109.8828 L316,1109.8828 L316,1092.75 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="250.1953" style="stroke:#000000;stroke-width:1.5;" width="569" x="316" y="1092.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="331" y="1105.8169">par</text><polygon fill="#181818" points="804.5,1127.0156,814.5,1131.0156,804.5,1135.0156,808.5,1131.0156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="352.5" x2="810.5" y1="1131.0156" y2="1131.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="359.5" y="1125.9497">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="381.5" y="1125.9497">Get new SSH CA public key</text><polygon fill="#181818" points="363.5,1156.1484,353.5,1160.1484,363.5,1164.1484,359.5,1160.1484" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="357.5" x2="815.5" y1="1160.1484" y2="1160.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="369.5" y="1155.0825">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192" x="391.5" y="1155.0825">Return new SSH CA public key</text><line style="stroke:#181818;stroke-width:1.0;" x1="352.5" x2="394.5" y1="1204.4141" y2="1204.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="394.5" x2="394.5" y1="1204.4141" y2="1217.4141"/><line style="stroke:#181818;stroke-width:1.0;" x1="353.5" x2="394.5" y1="1217.4141" y2="1217.4141"/><polygon fill="#181818" points="363.5,1213.4141,353.5,1217.4141,363.5,1221.4141,359.5,1217.4141" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="359.5" y="1191.7817">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="381.5" y="1184.2153">Apply new SSH CA</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="385.5" y="1199.3481">with SSH daemon</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="316" x2="885" y1="1226.4141" y2="1226.4141"/><polygon fill="#181818" points="804.5,1244.5469,814.5,1248.5469,804.5,1252.5469,808.5,1248.5469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="542.5" x2="810.5" y1="1248.5469" y2="1248.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="549.5" y="1243.481">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="571.5" y="1243.481">Get new SSH CA public key</text><polygon fill="#181818" points="553.5,1273.6797,543.5,1277.6797,553.5,1281.6797,549.5,1277.6797" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="547.5" x2="815.5" y1="1277.6797" y2="1277.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="559.5" y="1272.6138">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192" x="581.5" y="1272.6138">Return new SSH CA public key</text><line style="stroke:#181818;stroke-width:1.0;" x1="542.5" x2="584.5" y1="1321.9453" y2="1321.9453"/><line style="stroke:#181818;stroke-width:1.0;" x1="584.5" x2="584.5" y1="1321.9453" y2="1334.9453"/><line style="stroke:#181818;stroke-width:1.0;" x1="543.5" x2="584.5" y1="1334.9453" y2="1334.9453"/><polygon fill="#181818" points="553.5,1330.9453,543.5,1334.9453,553.5,1338.9453,549.5,1334.9453" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="549.5" y="1309.313">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="571.5" y="1301.7466">Apply new SSH CA</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="575.5" y="1316.8794">with SSH daemon</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="895" x="0" y="1370.5117"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="895" y1="1370.5117" y2="1370.5117"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="895" y1="1373.5117" y2="1373.5117"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="276" x="309.5" y="1359.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="257" x="315.5" y="1376.0122">Broadcast new SSH keys by admin</text><path d="M93,1398.0781 L93,1438.0781 L568,1438.0781 L568,1408.0781 L558,1398.0781 L93,1398.0781 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M558,1398.0781 L558,1408.0781 L568,1408.0781 L558,1398.0781 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285" x="183.75" y="1415.145">In this group we have an example with client,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248" x="183.75" y="1430.2778">but for server same steps should work.</text><path d="M93,1448.3438 L93,1473.3438 L568,1473.3438 L568,1458.3438 L558,1448.3438 L93,1448.3438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M558,1448.3438 L558,1458.3438 L568,1458.3438 L558,1448.3438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="354" x="149.25" y="1465.4106">Also before these steps admin should prepare CA keys.</text><line style="stroke:#181818;stroke-width:1.0;" x1="119.5" x2="161.5" y1="1499.6094" y2="1499.6094"/><line style="stroke:#181818;stroke-width:1.0;" x1="161.5" x2="161.5" y1="1499.6094" y2="1512.6094"/><line style="stroke:#181818;stroke-width:1.0;" x1="120.5" x2="161.5" y1="1512.6094" y2="1512.6094"/><polygon fill="#181818" points="130.5,1508.6094,120.5,1512.6094,130.5,1516.6094,126.5,1512.6094" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="126.5" y="1494.5435">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175" x="148.5" y="1494.5435">Generate new SSH key pair</text><line style="stroke:#181818;stroke-width:1.0;" x1="119.5" x2="161.5" y1="1556.875" y2="1556.875"/><line style="stroke:#181818;stroke-width:1.0;" x1="161.5" x2="161.5" y1="1556.875" y2="1569.875"/><line style="stroke:#181818;stroke-width:1.0;" x1="120.5" x2="161.5" y1="1569.875" y2="1569.875"/><polygon fill="#181818" points="130.5,1565.875,120.5,1569.875,130.5,1573.875,126.5,1569.875" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="126.5" y="1544.2427">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="148.5" y="1536.6763">Sign newly generated</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155" x="152.5" y="1551.8091">public key using SSH CA</text><line style="stroke:#181818;stroke-width:1.0;" x1="119.5" x2="161.5" y1="1614.1406" y2="1614.1406"/><line style="stroke:#181818;stroke-width:1.0;" x1="161.5" x2="161.5" y1="1614.1406" y2="1627.1406"/><line style="stroke:#181818;stroke-width:1.0;" x1="120.5" x2="161.5" y1="1627.1406" y2="1627.1406"/><polygon fill="#181818" points="130.5,1623.1406,120.5,1627.1406,130.5,1631.1406,126.5,1627.1406" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="126.5" y="1601.5083">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="148.5" y="1593.9419">Calculate hash of</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="152.5" y="1609.0747">newly generated key pair</text><path d="M93,1640.1406 L93,1695.1406 L568,1695.1406 L568,1650.1406 L558,1640.1406 L93,1640.1406 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M558,1640.1406 L558,1650.1406 L568,1650.1406 L558,1640.1406 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="272" x="121.25" y="1657.2075">Admin knows client and server public keys.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="410" x="121.25" y="1672.3403">So admin can generate shared secret keys for client and server.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226" x="121.25" y="1687.4731">Using Diffie-Hellman key exchange.</text><line style="stroke:#181818;stroke-width:1.0;" x1="119.5" x2="161.5" y1="1736.8047" y2="1736.8047"/><line style="stroke:#181818;stroke-width:1.0;" x1="161.5" x2="161.5" y1="1736.8047" y2="1749.8047"/><line style="stroke:#181818;stroke-width:1.0;" x1="120.5" x2="161.5" y1="1749.8047" y2="1749.8047"/><polygon fill="#181818" points="130.5,1745.8047,120.5,1749.8047,130.5,1753.8047,126.5,1749.8047" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="126.5" y="1724.1724">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152" x="148.5" y="1716.606">Generate shared secret</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="152.5" y="1731.7388">using client public key</text><line style="stroke:#181818;stroke-width:1.0;" x1="119.5" x2="161.5" y1="1794.0703" y2="1794.0703"/><line style="stroke:#181818;stroke-width:1.0;" x1="161.5" x2="161.5" y1="1794.0703" y2="1807.0703"/><line style="stroke:#181818;stroke-width:1.0;" x1="120.5" x2="161.5" y1="1807.0703" y2="1807.0703"/><polygon fill="#181818" points="130.5,1803.0703,120.5,1807.0703,130.5,1811.0703,126.5,1807.0703" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="126.5" y="1781.438">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="148.5" y="1773.8716">Encrypt newly created</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="152.5" y="1789.0044">SSH key pair</text><polygon fill="#181818" points="703.5,1832.2031,713.5,1836.2031,703.5,1840.2031,707.5,1836.2031" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="119.5" x2="709.5" y1="1836.2031" y2="1836.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="126.5" y="1831.1372">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175" x="148.5" y="1831.1372">Put encrypted SSH key pair</text><path d="M362,1849.2031 L362,1874.2031 L710,1874.2031 L710,1859.2031 L700,1849.2031 L362,1849.2031 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M700,1849.2031 L700,1859.2031 L710,1859.2031 L700,1849.2031 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="327" x="368" y="1866.27">https://docs.ipfs.tech/concepts/content-addressing/</text><polygon fill="#181818" points="130.5,1896.4688,120.5,1900.4688,130.5,1904.4688,126.5,1900.4688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="124.5" x2="714.5" y1="1900.4688" y2="1900.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="136.5" y="1895.4028">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="158.5" y="1895.4028">Return unique data CID</text><line style="stroke:#181818;stroke-width:1.0;" x1="119.5" x2="161.5" y1="1944.7344" y2="1944.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="161.5" x2="161.5" y1="1944.7344" y2="1957.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="120.5" x2="161.5" y1="1957.7344" y2="1957.7344"/><polygon fill="#181818" points="130.5,1953.7344,120.5,1957.7344,130.5,1961.7344,126.5,1957.7344" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="126.5" y="1932.1021">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="148.5" y="1924.5356">Encrypt CID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="152.5" y="1939.6685">using shared secret</text><polygon fill="#181818" points="804.5,1982.8672,814.5,1986.8672,804.5,1990.8672,808.5,1986.8672" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="119.5" x2="810.5" y1="1986.8672" y2="1986.8672"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="126.5" y="1981.8013">31</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="360" x="148.5" y="1981.8013">Save to smart contract encrypted CID with key pair hash</text><polygon fill="#181818" points="363.5,2012,353.5,2016,363.5,2020,359.5,2016" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="357.5" x2="815.5" y1="2016" y2="2016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="369.5" y="2010.9341">32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="301" x="391.5" y="2010.9341">Notify client about new SSH key pair availability</text><line style="stroke:#181818;stroke-width:1.0;" x1="352.5" x2="394.5" y1="2060.2656" y2="2060.2656"/><line style="stroke:#181818;stroke-width:1.0;" x1="394.5" x2="394.5" y1="2060.2656" y2="2073.2656"/><line style="stroke:#181818;stroke-width:1.0;" x1="353.5" x2="394.5" y1="2073.2656" y2="2073.2656"/><polygon fill="#181818" points="363.5,2069.2656,353.5,2073.2656,363.5,2077.2656,359.5,2073.2656" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="359.5" y="2047.6333">33</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152" x="381.5" y="2040.0669">Generate shared secret</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="385.5" y="2055.1997">using admin public key</text><line style="stroke:#181818;stroke-width:1.0;" x1="352.5" x2="394.5" y1="2102.3984" y2="2102.3984"/><line style="stroke:#181818;stroke-width:1.0;" x1="394.5" x2="394.5" y1="2102.3984" y2="2115.3984"/><line style="stroke:#181818;stroke-width:1.0;" x1="353.5" x2="394.5" y1="2115.3984" y2="2115.3984"/><polygon fill="#181818" points="363.5,2111.3984,353.5,2115.3984,363.5,2119.3984,359.5,2115.3984" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="359.5" y="2097.3325">34</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="381.5" y="2097.3325">Decrypt unique CID</text><polygon fill="#181818" points="703.5,2155.6641,713.5,2159.6641,703.5,2163.6641,707.5,2159.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="352.5" x2="709.5" y1="2159.6641" y2="2159.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="359.5" y="2147.0317">35</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216" x="381.5" y="2139.4653">Download encrypted SSH key pair</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="385.5" y="2154.5981">using decrypted CID</text><polygon fill="#181818" points="363.5,2184.7969,353.5,2188.7969,363.5,2192.7969,359.5,2188.7969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="357.5" x2="714.5" y1="2188.7969" y2="2188.7969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="369.5" y="2183.731">36</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="391.5" y="2183.731">Encrypted SSH key pair</text><line style="stroke:#181818;stroke-width:1.0;" x1="352.5" x2="394.5" y1="2217.9297" y2="2217.9297"/><line style="stroke:#181818;stroke-width:1.0;" x1="394.5" x2="394.5" y1="2217.9297" y2="2230.9297"/><line style="stroke:#181818;stroke-width:1.0;" x1="353.5" x2="394.5" y1="2230.9297" y2="2230.9297"/><polygon fill="#181818" points="363.5,2226.9297,353.5,2230.9297,363.5,2234.9297,359.5,2230.9297" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="359.5" y="2212.8638">37</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="381.5" y="2212.8638">Decrypt SSH key pair</text><line style="stroke:#181818;stroke-width:1.0;" x1="352.5" x2="394.5" y1="2305.4609" y2="2305.4609"/><line style="stroke:#181818;stroke-width:1.0;" x1="394.5" x2="394.5" y1="2305.4609" y2="2318.4609"/><line style="stroke:#181818;stroke-width:1.0;" x1="353.5" x2="394.5" y1="2318.4609" y2="2318.4609"/><polygon fill="#181818" points="363.5,2314.4609,353.5,2318.4609,363.5,2322.4609,359.5,2318.4609" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="359.5" y="2277.6958">38</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="381.5" y="2254.9966">Validate that</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="385.5" y="2270.1294">decrypted SSH key pair</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="385.5" y="2285.2622">matches hash</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="385.5" y="2300.395">from smart contract</text><line style="stroke:#181818;stroke-width:1.0;" x1="352.5" x2="394.5" y1="2362.7266" y2="2362.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="394.5" x2="394.5" y1="2362.7266" y2="2375.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="353.5" x2="394.5" y1="2375.7266" y2="2375.7266"/><polygon fill="#181818" points="363.5,2371.7266,353.5,2375.7266,363.5,2379.7266,359.5,2375.7266" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="359.5" y="2350.0942">39</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="381.5" y="2342.5278">Apply new SSH key pair</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="385.5" y="2357.6606">with SSH daemon</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="113" x="411.5" y="2407.937">Some time (ex: 1m)</text><polygon fill="#181818" points="703.5,2441.6641,713.5,2445.6641,703.5,2449.6641,707.5,2445.6641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="119.5" x2="709.5" y1="2445.6641" y2="2445.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="126.5" y="2440.5981">40</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="148.5" y="2440.5981">Delete data and unpin CID</text><path d="M124,2458.6641 L124,2483.6641 L401,2483.6641 L401,2468.6641 L391,2458.6641 L124,2458.6641 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M391,2458.6641 L391,2468.6641 L401,2468.6641 L391,2458.6641 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256" x="130" y="2475.731">Encrypted key pair is no longer available</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="895" x="0" y="2509.3633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="895" y1="2509.3633" y2="2509.3633"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="895" y1="2512.3633" y2="2512.3633"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="150" x="372.5" y="2498.7969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="131" x="378.5" y="2514.8638">SSH keys rotation</text><path d="M93,2536.9297 L93,2576.9297 L568,2576.9297 L568,2546.9297 L558,2536.9297 L93,2536.9297 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M558,2536.9297 L558,2546.9297 L568,2546.9297 L558,2536.9297 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="291" x="180.75" y="2553.9966">In this group we have an example with server,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242" x="180.75" y="2569.1294">but for client same steps should work.</text><polygon fill="#181818" points="804.5,2599.3281,814.5,2603.3281,804.5,2607.3281,808.5,2603.3281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="119.5" x2="810.5" y1="2603.3281" y2="2603.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="126.5" y="2598.2622">41</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="148.5" y="2598.2622">Revoke existing SSH key pair</text><polygon fill="#181818" points="553.5,2628.4609,543.5,2632.4609,553.5,2636.4609,549.5,2632.4609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="547.5" x2="815.5" y1="2632.4609" y2="2632.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="559.5" y="2627.395">42</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="581.5" y="2627.395">Notify about revokation</text><line style="stroke:#181818;stroke-width:1.0;" x1="542.5" x2="584.5" y1="2676.7266" y2="2676.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="584.5" x2="584.5" y1="2676.7266" y2="2689.7266"/><line style="stroke:#181818;stroke-width:1.0;" x1="543.5" x2="584.5" y1="2689.7266" y2="2689.7266"/><polygon fill="#181818" points="553.5,2685.7266,543.5,2689.7266,553.5,2693.7266,549.5,2689.7266" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="549.5" y="2664.0942">43</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="571.5" y="2656.5278">Apply changes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="575.5" y="2671.6606">with SSH daemon</text><rect fill="none" height="67.0391" style="stroke:#000000;stroke-width:1.5;" width="227" x="510.5" y="2697.7266"/><path d="M510.5,2697.7266 L576.5,2697.7266 L576.5,2704.7266 L566.5,2714.7266 L510.5,2714.7266 L510.5,2697.7266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="523.5" y="2711.7935">ref</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="219" x="514.5" y="2729.8652">To have new key pair on the server</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="209" x="519.5" y="2743.834">it is required to go through steps</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="139" x="554.5" y="2757.8027">from previous section.</text><!--SRC=[fLTBRzms4BxpLn2vj0LY6RqKg04NSBrfOXGjZ6pQN7pXIgCLOOfKI6hN- -yxGrAlbUGr6Y1m974UttppuhfdgHjXHSsBHl9VVs6YzKQtzGuiOtZWPIuReJs_AsgfkN1SqCFaw5v9mF_mB0zFayCjs0DOEdJXQNBuyFZ7bevaKxh9mRjjZM_ytcXlHUxV1UFfXR7RMpJhsuOxK_gZiC2TXyRnsrl6jF70JN19GDydI5yhqF4BbzfvePGRj8rEoBdGHSB9fSSdx_ZkH9vBkMSItynHywRTAPdpPpXb_4uvqukw0Bh3YUuA2yvbZ6tDu2mNcdlREizZmAqITgQ9C2BOaIy6-9N2O_7ewhU4-eO_n93uvl7FXzxJ81OZMXDZGc5wCUsyDWKmJhZmB-S3bT7F-vH1EljIISVteC4A3mNXGpM9h3bIunPK-7wKlkBRxQSiA7q5hW6_8b_exMZiSnHOY1xFfVOGteDC22PBleN_mKryreQA03J-y_80t5V8ClhjXTn4zLYTEl0Ia-ygqwg2xu0trkIOCiH8VL3ZSOw4dGXIq4-I60RHea2Whm8ECeTelqyHlQIQ6kNfOoAiXtKc5uAymU96CqFcesNbejLKdgEqBbiTv5QjuWV6ndcEBTEd6Sisrj2pDaUN0dKZ6mw5A5lT2Saj5Ew85mg3_oLqArHNRkjbze2TGdMM2rIAPgbxzk2dSPJMr0a3zN9gy9XRWr6LFlJp1CXGvczDqwphFavmZ55Cx0uPUFpEbCuQ-WA2pkuA0af_A06SfxzR8mha6MVk7Sy11rE9fOy0QARsVfEL7fs6O-WorEc13ZIbViRAepOPoOwIns8M-juVqVktGH3OUZlJ-XNjnE1OkwFcBTeKU_8_r42FciXTLXnx707-Z3l9wdMTMPtTDGtEba7-IVS3anS2QgEx28SA-H_uEaeku9jNuLlmpUgd4wVnGCipriFIQavztdNvtXfSwKVW5PKBzZcyYBfH47scsS1scCuIcpgXTQBkjd-QpRHMHhjopMjOt3ieQN7u2bnd9S9DjXeB3UtiMDzkRFPYJymRefl3SX-Ie4x30dqQ3qpUEgdtYVEP-hrGT6Vmn9Ehk2cVPjO6twlHZyRw_Eep6l0PwvT07BqfIbSXBwIGMop3a6lAoinMnlu9mMnaMKgu-WHArMY70C9BZbjw3qiNctDI9-umuCXGyZOU9-SMFkZSdXgV64BjnFPoXkWUIaFIusmCUkXp8XdeL53w95fvtxYRw-l2v2wZJvc7lBh6zikXyOuUF4AyIbT117tDI6myarDRjbf-Q_4s8RpWzm-RrKZmh2TWGWjR7RrucJgxOWtXeRdOOFrrYigAlJAGknnF9cklBGv2Ah6JIdfCnokxTJcbvvU71GiRY4GameYhGIYcPOFNT8K3QIMDlRS2HZGCYUayVLWkWbSmJUJcOlyA9GiA7k-d5FFW_mmUtZnp74eX5_WQ5liqXUpIEXbPEn_QBCiolDpXvFGI__m8BpVyv_edZf_PUJDiG85FPKbjtUe6Zuckq0jMxYj_LgAptmDS6UpplZOKn9zmtPAmniUxsdSlYIWyB8d4qUKbiT0vd-5WdW7jI-UxSJoazjADmv9sY8gjxTKu_TnIVYoKaOCK_HSJuwNSzjGQeWGw4VnDXVHO-DPAQYji-Rt1SwHhNyNOMQWYN6a7QLhwEPuJlC02-my0]--></g></svg>